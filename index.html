<!DOCTYPE html>
<html lang="hu">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>IBAR - IngÃ¡s BlokkoldÃ³ Asszisztens Rendszer</title>
<script src="https://cdn.jsdelivr.net/npm/docx@7.8.2/build/index.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
<style>
/* Login Screen Styles */
#loginScreen{display:flex;align-items:center;justify-content:center;min-height:100vh;background:linear-gradient(135deg,#f5f3ff,#ede9fe,#fce7f3);padding:20px}
#loginScreen .card{background:#fff;border-radius:24px;box-shadow:0 20px 60px rgba(147,51,234,.15);padding:48px 40px;max-width:440px;width:100%;text-align:center}
#loginScreen .logo{width:90px;height:90px;margin:0 auto 24px;background:linear-gradient(135deg,#9333ea,#ec4899);border-radius:22px;display:flex;align-items:center;justify-content:center;font-size:45px;box-shadow:0 10px 30px rgba(147,51,234,.3)}
#loginScreen h1{font-size:2rem;color:#9333ea;margin-bottom:8px}
#loginScreen p{color:#6b7280;margin-bottom:36px;font-size:.95rem}
#loginScreen input{width:100%;padding:18px;border:2px solid #e5e7eb;border-radius:14px;font-size:1.1rem;text-align:center;font-weight:700;letter-spacing:2px;margin-bottom:20px;box-sizing:border-box}
#loginScreen input:focus{outline:0;border-color:#9333ea;box-shadow:0 0 0 4px rgba(147,51,234,.12)}
#loginScreen button{width:100%;padding:18px;background:linear-gradient(135deg,#9333ea,#ec4899);color:#fff;border:0;border-radius:14px;font-size:1.1rem;font-weight:700;cursor:pointer}
#loginScreen button:hover{transform:translateY(-2px);box-shadow:0 12px 30px rgba(147,51,234,.35)}
.err{background:#fef2f2;border-left:4px solid #ef4444;color:#991b1b;padding:14px;border-radius:10px;margin-top:18px;font-size:.92rem;display:none}
.err.show{display:block}
#appScreen{display:none}
body.logged-in #loginScreen{display:none}
body.logged-in #appScreen{display:block}

        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #f5f3ff 0%, #ede9fe 50%, #fce7f3 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .container { max-width: 1000px; margin: 0 auto; }
        .card {
            background: white;
            border-radius: 16px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            padding: 24px;
            margin-bottom: 24px;
        }
        .header { text-align: center; }
        .header h1 { font-size: 2rem; color: #9333ea; margin-bottom: 8px; }
        .header p { color: #6b7280; font-size: 0.875rem; }
        .progress-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 16px;
            font-size: 0.875rem;
            font-weight: 600;
        }
        .progress-bar-container {
            width: 100%;
            height: 12px;
            background: #e5e7eb;
            border-radius: 999px;
            overflow: hidden;
            margin-bottom: 16px;
        }
        .progress-bar {
            height: 100%;
            background: linear-gradient(to right, #9333ea, #ec4899);
            transition: width 0.5s ease;
        }
        .steps-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(40px, 1fr));
            gap: 4px;
            margin-top: 16px;
        }
        .step-icon {
            text-align: center;
            font-size: 1.25rem;
            transition: all 0.3s;
            cursor: pointer;
            padding: 8px 4px;
            border-radius: 8px;
        }
        .step-icon.active { 
            color: #9333ea; 
            font-weight: bold; 
            transform: scale(1.2); 
            background: #f3e8ff;
        }
        .step-icon.completed { color: #10b981; }
        .step-icon.pending { color: #9ca3af; }
        .content-card h2 {
            font-size: 1.5rem;
            color: #1f2937;
            margin-bottom: 24px;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .info-box { padding: 16px; border-radius: 8px; margin-bottom: 24px; }
        .info-box.blue { background: #eff6ff; border-left: 4px solid #3b82f6; color: #1e40af; }
        .info-box.purple { background: #faf5ff; border-left: 4px solid #a855f7; color: #6b21a8; }
        .info-box.yellow { background: #fefce8; border: 1px solid #fde047; color: #854d0e; }
        .info-box.green { background: #f0fdf4; border: 1px solid #86efac; color: #15803d; }
        .question-box {
            background: #fef3c7;
            border-left: 4px solid #f59e0b;
            padding: 16px;
            border-radius: 8px;
            margin-bottom: 16px;
            font-weight: 600;
            color: #92400e;
        }
        .btn {
            width: 100%;
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 8px;
        }
        .btn-primary { background: #3b82f6; color: white; }
        .btn-primary:hover { background: #2563eb; }
        .btn-purple { background: #9333ea; color: white; }
        .btn-purple:hover { background: #7e22ce; }
        .btn-secondary { background: #d1d5db; color: #374151; }
        .btn-secondary:hover { background: #9ca3af; }
        .btn-download { background: #8b5cf6; color: white; margin-top: 12px; }
        .btn-download:hover { background: #7c3aed; }
        .btn-skip { background: #fbbf24; color: #78350f; }
        .btn-skip:hover { background: #f59e0b; }
        .btn-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-top: 16px;
        }
        .modal {
            display: none;
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.6);
            z-index: 1000;
            padding: 20px;
            overflow-y: auto;
        }
        .modal.active { display: flex; align-items: center; justify-content: center; }
        .modal-content {
            background: white;
            border-radius: 16px;
            padding: 32px;
            max-width: 900px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
        }
        .diagram-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 12px;
            margin-top: 16px;
        }
        .diagram-button {
            background: #faf5ff;
            border: 2px solid #d8b4fe;
            color: #6b21a8;
            padding: 12px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            font-size: 0.9rem;
        }
        .diagram-button:hover { background: #f3e8ff; transform: translateY(-2px); }
        .diagram-button.selected { 
            background: #9333ea; 
            color: white; 
            border-color: #7e22ce;
        }
        .answer-display {
            background: #f9fafb;
            padding: 12px;
            border-radius: 8px;
            margin: 8px 0;
            text-align: left;
        }
        .answer-label {
            font-weight: 600;
            color: #6b21a8;
            margin-bottom: 4px;
        }
        .answer-value {
            color: #1f2937;
        }
        .slider-container {
            margin: 24px 0;
        }
        .slider-group {
            margin-bottom: 24px;
        }
        .slider-group label {
            display: block;
            font-weight: 600;
            margin-bottom: 12px;
            color: #6b21a8;
            font-size: 1.1rem;
        }
        .slider-wrapper {
            display: flex;
            align-items: center;
            gap: 16px;
        }
        .slider {
            flex: 1;
            height: 8px;
            border-radius: 4px;
            background: #e5e7eb;
            outline: none;
            -webkit-appearance: none;
        }
        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: #9333ea;
            cursor: pointer;
        }
        .slider::-moz-range-thumb {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: #9333ea;
            cursor: pointer;
            border: none;
        }
        .slider-value {
            min-width: 50px;
            font-weight: bold;
            color: #9333ea;
            font-size: 1.2rem;
        }
        .generated-text {
            background: #f0fdf4;
            border: 2px solid #86efac;
            padding: 16px;
            border-radius: 8px;
            margin: 16px 0;
            line-height: 1.8;
            white-space: pre-wrap;
            text-align: left;
            min-height: 200px;
        }
        input[type="text"], textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #d8b4fe;
            border-radius: 8px;
            font-size: 1rem;
            font-family: inherit;
        }
        textarea {
            min-height: 150px;
            resize: vertical;
        }
        .summary-section {
            margin-top: 24px;
        }
        .summary-section h3 {
            color: #7e22ce;
            margin-bottom: 16px;
        }
        @media (max-width: 768px) {
            .header h1 { font-size: 1.5rem; }
            .btn-grid { grid-template-columns: 1fr; }
            .steps-grid { grid-template-columns: repeat(auto-fit, minmax(35px, 1fr)); }
        }
    
</style>
</head>
<body>
<!-- LOGIN SCREEN -->
<div id="loginScreen">
<div class="card">
<div class="logo">ğŸ¯</div>
<h1>IBAR</h1>
<p>IngÃ¡s BlokkoldÃ³ Asszisztens Rendszer</p>
<input type="text" id="codeInput" placeholder="IBAR-2025-XXX" maxlength="13" autocomplete="off">
<button onclick="doLogin()">BelÃ©pÃ©s</button>
<div class="err" id="errMsg">âŒ Ã‰rvÃ©nytelen kÃ³d</div>
</div>
</div>

<!-- APP SCREEN -->
<div id="appScreen">

    <div class="container">
        <div class="card header">
            <h1>ğŸ¯ IngÃ¡s BlokkoldÃ³ Asszisztens</h1>
            <p>FÃ³kusz â€“ FeltÃ¡rÃ¡s â€“ OldÃ¡s â€“ IntegrÃ¡ciÃ³</p>
        </div>

        <div class="card">
            <div class="progress-info">
                <span id="stepInfo">0/32 lÃ©pÃ©s</span>
                <span id="percentInfo">0%</span>
            </div>
            <div class="progress-bar-container">
                <div class="progress-bar" id="progressBar" style="width: 0%"></div>
            </div>
            <div class="steps-grid" id="stepsGrid"></div>
        </div>

        <div class="card content-card" id="contentCard"></div>

        <div class="card" id="navigationCard" style="display: none;">
            <div class="btn-grid">
                <button class="btn btn-secondary" onclick="prevStep()">â† Vissza</button>
                <button class="btn btn-purple" onclick="nextStep()">TovÃ¡bb â†’</button>
            </div>
        </div>
    </div>

    <div class="modal" id="diagramModal">
        <div class="modal-content">
            <h3 id="diagramTitle">Diagram</h3>
            <div class="question-box" id="diagramQuestion"></div>
            <div id="diagramContent"></div>
        </div>
    </div>

    <script>
let currentStep = 0;
let completedSteps = [];
let selectedOptions = [];
let sessionData = {
    answers: {},
    measurements: { initial: null, final: null },
    temValues: { Testi: 0, Erzelmi: 0, Mentalis: 0 },
    releasingTexts: '',
    integratingTexts: '',
    timestamp: null,
    clientName: ''
};

const steps = [
    { id: 0, name: 'RÃ¡hangolÃ³dÃ¡s', icon: 'ğŸ¯' },
    { id: 1, name: 'EngedÃ©lyezÃ©s', icon: 'âœ‹', diagram: 'igenNem', question: 'EngedÃ©lyezett-e most a blokkoldÃ³ munka?' },
    { id: 2, name: 'Kezdeti mÃ©rÃ©s', icon: 'ğŸ“Š', diagram: 'szazalek', question: 'Mennyire erÅ‘s ez a blokk jelenleg? (0-100%)' },
    { id: 3, name: 'Ã‰letterÃ¼let', icon: 'ğŸŒ', diagram: 'eletterulet', question: 'Melyik Ã©letterÃ¼leten jelentkezik ez a blokk?', multiple: true },
    { id: 4, name: 'Ã‰rzelmi GyÃ¶kÃ©r', icon: 'ğŸŒ±', diagram: 'erzelmGyoker', question: 'Mi az Ã©rzelmi gyÃ¶kere ennek a blokknak?', multiple: true },
    { id: 5, name: 'NegatÃ­v Ã‰rzelem', icon: 'ğŸ’­', diagram: 'erzelem', question: 'Mely negatÃ­v Ã©rzelem dominÃ¡l?', multiple: true },
    { id: 6, name: 'Trauma', icon: 'ğŸ”', diagram: 'trauma', question: 'Van-e traumatikus esemÃ©ny a hÃ¡ttÃ©rben?', multiple: true },
    { id: 7, name: 'Lelki SÃ©rÃ¼lÃ©s', icon: 'ğŸ’”', diagram: 'lelkiSerules', question: 'Milyen lelki sÃ©rÃ¼lÃ©s hÃºzÃ³dik meg mÃ¶gÃ¶tte?', multiple: true },
    { id: 8, name: 'Kapcsolati GyÃ¶kÃ©r', icon: 'ğŸ‘¥', diagram: 'kapcsolat', question: 'Melyik kapcsolathoz kÃ¶thetÅ‘ ez a blokk?', multiple: true },
    { id: 9, name: 'Blokk Eredete', icon: 'â³', diagram: 'eredet', question: 'Mikor keletkezett ez a blokk?', multiple: true },
    { id: 10, name: 'Hiedelmek', icon: 'ğŸ§ ', diagram: 'hiedelem', question: 'Milyen korlÃ¡tozÃ³ hiedelem Ã¡ll a hÃ¡ttÃ©rben?', multiple: true },
    { id: 11, name: 'Testi Ã‰rintettsÃ©g', icon: 'ğŸ«€', diagram: 'test', question: 'A test mely rÃ©sze Ã©rintett?', multiple: true },
    { id: 12, name: 'Csakra', icon: 'ğŸŒˆ', diagram: 'csakra', question: 'Melyik csakra Ã©rintett?', multiple: true },
    { id: 13, name: 'Blokk Jellege', icon: 'ğŸ”·', diagram: 'blokkJelleg', question: 'Milyen jellegÅ± ez a blokk?', multiple: true },
    { id: 14, name: 'TEM - Testi', icon: 'ğŸ«€', diagram: 'szazalek', question: 'Testi szint mÃ©rÃ©se (0-100%)' },
    { id: 15, name: 'TEM - Ã‰rzelmi', icon: 'ğŸ’­', diagram: 'szazalek', question: 'Ã‰rzelmi szint mÃ©rÃ©se (0-100%)' },
    { id: 16, name: 'TEM - MentÃ¡lis', icon: 'ğŸ§ ', diagram: 'szazalek', question: 'MentÃ¡lis szint mÃ©rÃ©se (0-100%)' },
    { id: 17, name: 'TEM MÃ©rÃ©s', icon: 'ğŸ”º' },
    { id: 18, name: 'VÃ©dekezÃ©s', icon: 'ğŸ›¡ï¸', diagram: 'vedekezes', question: 'Milyen vÃ©dekezÃ©si mechanizmus mÅ±kÃ¶dik?', multiple: true },
    { id: 19, name: 'Ã‰letszerep', icon: 'ğŸ­', diagram: 'szerepek', question: 'Melyik Ã©letszerepben jelentkezik ez a blokk?', multiple: true },
    { id: 20, name: 'SzabotÃ¡zs', icon: 'ğŸš«', diagram: 'szabotazs', question: 'Milyen Ã¶nszabotÃ¡zs minta jelenik meg?', multiple: true },
    { id: 21, name: 'MÃ¡sodl. Haszon', icon: 'ğŸ”', diagram: 'haszon', question: 'Mi a mÃ¡sodlagos haszna a blokknak?', multiple: true },
    { id: 22, name: 'Fogadalmak', icon: 'ğŸ•Šï¸', diagram: 'fogadalom', question: 'Van-e fogadalom vagy eskÃ¼ a hÃ¡ttÃ©rben?', multiple: true },
    { id: 23, name: 'MikroszkÃ³p', icon: 'ğŸ”¬', diagram: 'mikroszkop', question: 'Van-e mÃ©lyebb rÃ©teg, amit meg kell vizsgÃ¡lni?', multiple: true },
    { id: 24, name: 'KÃ©szÃ¼ltsÃ©g', icon: 'âš¡', diagram: 'igenNem', question: 'KÃ©szen Ã¡ll a kliens az oldÃ¡sra?' },
    { id: 25, name: 'OldÃ¡s', icon: 'âœ¨' },
    { id: 26, name: 'PozitÃ­v Ã‰rzelem', icon: 'ğŸ˜Š', diagram: 'pozitivErzelem', question: 'Milyen pozitÃ­v Ã©rzelmet szeretne Ã©rezni helyette?', multiple: true },
    { id: 27, name: 'Ãšj Hit', icon: 'ğŸ’«', diagram: 'ujHit', question: 'Milyen Ãºj hitet szeretne magÃ¡Ã©vÃ¡ tenni?', multiple: true },
    { id: 28, name: 'SzÃ­nek', icon: 'ğŸ¨', diagram: 'szinek', question: 'Mely szÃ­n tÃ¡mogatja a gyÃ³gyulÃ¡st?', multiple: true },
    { id: 29, name: 'KristÃ¡lyok', icon: 'ğŸ’', diagram: 'kristaly', question: 'Mely kristÃ¡ly segÃ­t az integrÃ¡ciÃ³ban?', multiple: true },
    { id: 30, name: 'ZÃ¡rÃ³ mÃ©rÃ©s', icon: 'ğŸ“ˆ', diagram: 'szazalek', question: 'Mennyire erÅ‘s a blokk most? (0-100%)' },
    { id: 31, name: 'OldÃ³ SzÃ¶vegek', icon: 'ğŸ“–' },
    { id: 32, name: 'LezÃ¡rÃ¡s', icon: 'ğŸ™' }
];

const diagrams = {
    igenNem: { 
        title: 'Igen - Nem - Nem most', 
        options: ['IGEN', 'NEM', 'NEM MOST'],
        colors: ['#bbf7d0', '#fecaca', '#fde68a']
    },
    szazalek: { 
        title: 'SzÃ¡zalÃ©kos mÃ©rÃ©s', 
        options: ['0%','10%','20%','30%','40%','50%','60%','70%','80%','90%','100%'],
        colors: ['#fecaca','#fed7aa','#fde68a','#fef3c7','#d9f99d','#bbf7d0','#a7f3d0','#99f6e4','#a5f3fc','#bfdbfe','#c7d2fe']
    },
    eletterulet: { 
        title: 'Ã‰letterÃ¼letek', 
        options: ['Munka/Karrier', 'PÃ©nzÃ¼gyek', 'Szerelem/PÃ¡rkapcsolat', 'CsalÃ¡d', 'EgÃ©szsÃ©g', 'BarÃ¡tsÃ¡gok', 'SpiritualitÃ¡s', 'Otthon/LakhatÃ¡s', 'SzabadidÅ‘/Hobbik', 'KreativitÃ¡s/AlkotÃ¡s', 'Ã–nÃ©rtÃ©kelÃ©s/Ã–nbizalom', 'SzexualitÃ¡s/IntimitÃ¡s', 'TanulÃ¡s/FejlÅ‘dÃ©s', 'KommunikÃ¡ciÃ³', 'CÃ©ltudatossÃ¡g/JÃ¶vÅ‘kÃ©p'],
        colors: ['#fecaca','#fed7aa','#fde68a','#d9f99d','#bbf7d0','#99f6e4','#bfdbfe','#c7d2fe','#ddd6fe','#e9d5ff','#fbcfe8','#fca5a5','#a7f3d0','#fef3c7','#c7d2fe']
    },
    erzelmGyoker: {
        title: 'Ã‰rzelmi GyÃ¶kÃ©r',
        options: ['FÃ©lelem/SzorongÃ¡s', 'Harag/DÃ¼h', 'SzomorÃºsÃ¡g/GyÃ¡sz', 'Ã–rÃ¶m (elfojtott)', 'Szeretet (hiÃ¡nya)', 'Bizalom (hiÃ¡nya)', 'BÅ±ntudat', 'SzÃ©gyen', 'MegvetÃ©s', 'Undor', 'MeglepetÃ©s (trauma)', 'VÃ¡gy/HiÃ¡ny', 'Ã‰rzelmi zsibbadÃ¡s', 'FÃ¡jdalom', 'Rejtett vÃ¡gy', 'TehetetlensÃ©g', 'Elfojtott dÃ¼h', 'MagÃ¡ny'],
        colors: ['#fca5a5', '#fecaca', '#bfdbfe', '#fde68a', '#fbcfe8', '#d1d5db', '#fed7aa', '#fcd34d', '#ddd6fe', '#99f6e4', '#fef3c7', '#f9a8d4', '#e5e7eb', '#fca5a5', '#f5d0fe', '#fecdd3', '#fed7aa', '#c7d2fe']
    },
    erzelem: { 
        title: 'NegatÃ­v Ã‰rzelmek', 
        options: ['Harag/DÃ¼h', 'SzomorÃºsÃ¡g/BÃ¡nat', 'FÃ©lelem/Aggodalom', 'BÅ±ntudat/SzÃ©gyen', 'FrusztrÃ¡ciÃ³', 'IrigysÃ©g', 'ElhagyatottsÃ¡g', 'RemÃ©nytelensÃ©g', 'KÃ©tsÃ©gbeesÃ©s', 'KishitÅ±sÃ©g', 'BefelÃ© fordÃ­tott dÃ¼h', 'MegkeseredÃ©s'],
        colors: ['#fecaca','#fca5a5','#fcd5d5','#fed7aa','#fecaca','#fca5a5','#fecdd3','#fca5a5','#fed7aa','#fcd5d5','#fecaca','#fca5a5']
    },
    trauma: {
        title: 'Trauma MÃ©lyÃ­tÃ©s',
        options: ['Gyerekkori trauma', 'BÃ¡ntalmazÃ¡s', 'ElhanyagolÃ¡s', 'SzexuÃ¡lis trauma', 'Ã‰rzelmi manipulÃ¡ciÃ³', 'CsalÃ¡di konfliktus', 'VÃ¡lÃ¡s', 'HalÃ¡leset', 'VesztesÃ©g', 'Baleset', 'BetegsÃ©g', 'Iskolai bÃ¡ntalmazÃ¡s', 'ElÃ¡rulÃ¡s', 'IsmÃ©tlÅ‘dÅ‘ kudarc', 'Ã–rÃ¶klÃ¶tt trauma', 'Orvosi beavatkozÃ¡s', 'TermÃ©szeti katasztrÃ³fa', 'HÃ¡borÃºs trauma', 'SzÃ¼lÃ©si trauma'],
        colors: ['#fca5a5','#fcd5d5','#fecaca','#fecdd3','#fca5a5','#fed7aa','#fde68a','#fecaca','#fca5a5','#fcd5d5','#fed7aa','#fecaca','#fca5a5','#fcd5d5','#fecdd3','#fed7aa','#fde68a','#fecaca','#fca5a5']
    },
    lelkiSerules: {
        title: 'Lelki SÃ©rÃ¼lÃ©sek',
        options: ['ElutasÃ­tÃ¡s', 'ElhagyÃ¡s', 'MegalÃ¡zÃ¡s', 'ÃrulÃ¡s', 'IgazsÃ¡gtalansÃ¡g', 'LÃ¡thatatlansÃ¡g', 'Meg nem hallgatÃ¡s', 'Ã‰rzelmi elhanyagolÃ¡s', 'Fizikai elhanyagolÃ¡s', 'TÃºlvÃ©dÃ©s', 'HatÃ¡rok Ã¡tlÃ©pÃ©se', 'GyermekkÃ©nt kezelÃ©s', 'SzÃ¼lÅ‘i szerep rÃ¡kÃ©nyszerÃ­tÃ©se', 'BÅ±nbakkÃ©pzÃ©s', 'KirekesztÃ©s', 'Ã‰rzelmi zsarolÃ¡s', 'ValÃ³sÃ¡g tagadÃ¡sa', 'ÃllandÃ³ kritika', 'Ã–sszehasonlÃ­tÃ¡s', 'FeltÃ©teles szeretet', 'Meg nem Ã©rtÃ©s', 'TÃºlterhelÃ©s', 'ManipulÃ¡ciÃ³'],
        colors: ['#fca5a5', '#fcd34d', '#fdba74', '#d8b4fe', '#bfdbfe', '#a5f3fc', '#99f6e4', '#bbf7d0', '#fde68a', '#fecaca', '#ddd6fe', '#e9d5ff', '#fbcfe8', '#fecdd3', '#fed7aa', '#fef3c7', '#ccfbf1', '#c7d2fe', '#ddd6fe', '#fbcfe8', '#a7f3d0', '#fcd5d5', '#e9d5ff']
    },
    kapcsolat: {
        title: 'Kapcsolati GyÃ¶kÃ©r',
        options: ['Ã‰n magam', 'Anya', 'Apa', 'TestvÃ©r', 'Gyerek', 'Partner', 'HÃ¡zastÃ¡rs', 'Volt partner', 'BarÃ¡t', 'KollÃ©ga', 'FÅ‘nÃ¶k', 'TanÃ¡r', 'Mentor', 'NagyszÃ¼lÅ‘', 'Rokon', 'Isten/Magasabb Ã‰n', 'ElÅ‘zÅ‘ generÃ¡ciÃ³/ÅsÃ¶k'],
        colors: ['#e9d5ff','#fbcfe8','#bfdbfe','#bbf7d0','#fde68a','#fecaca','#fca5a5','#fcd5d5','#a7f3d0','#c7d2fe','#e9d5ff','#ddd6fe','#d8b4fe','#fed7aa','#fcd34d','#f5d0fe','#c7d2fe']
    },
    eredet: {
        title: 'Blokk Eredete',
        options: ['0-3 Ã©v', '3-7 Ã©v', '7-14 Ã©v', '14-21 Ã©v', '21-35 Ã©v', '35-50 Ã©v', '50+ Ã©v', 'MÃ©hen belÃ¼l', 'SzÃ¼letÃ©s', 'Korai gyerek', 'IskolÃ¡s kor', 'PubertÃ¡s', 'Fiatal felnÅ‘tt', 'MÃºlt Ã©let', 'GenerÃ¡ciÃ³s'],
        colors: ['#fecaca','#fed7aa','#fde68a','#d9f99d','#bbf7d0','#a7f3d0','#99f6e4','#fca5a5','#fcd5d5','#fecaca','#fed7aa','#fde68a','#d9f99d','#ddd6fe','#e9d5ff']
    },
    hiedelem: { 
        title: 'KorlÃ¡tozÃ³ Hiedelmek', 
        options: ['Nem vagyok elÃ©g jÃ³', 'Nem Ã©rdemlem meg', 'Nem vagyok szerethetÅ‘', 'Gyenge vagyok', 'Mindig kudarcot vallok', 'VeszÃ©lyes a siker', 'Nem lehetek boldog', 'Nem vagyok tehetsÃ©ges', 'Sosem vÃ¡ltozhatok', 'Nem Ã©rdemlem meg a sikert', 'VeszÃ©lyes kifejezni magam', 'Mindig beteg vagyok', 'Nem bÃ­zhatok senkiben', 'A pÃ©nz rossz'],
        colors: ['#d1d5db','#e5e7eb','#d1d5db','#e5e7eb','#d1d5db','#e5e7eb','#d1d5db','#e5e7eb','#d1d5db','#e5e7eb','#d1d5db','#e5e7eb','#d1d5db','#e5e7eb']
    },
    test: { 
        title: 'TesttÃ¡jÃ©kok', 
        options: ['Fej/Agy', 'Torok/Nyak', 'SzÃ­v/Mellkas', 'Gyomor/Has', 'MÃ¡j/EpehÃ³lyag', 'Vese', 'HÃ¡t/Gerinc', 'DerÃ©k/ÃgyÃ©k', 'CsÃ­pÅ‘/Medence', 'VÃ©gtagok'],
        colors: ['#e9d5ff','#ddd6fe','#d8b4fe','#e9d5ff','#f3e8ff','#d8b4fe','#ddd6fe','#e9d5ff','#e0d5f5','#d4c5f9']
    },
    csakra: {
        title: 'CsakrÃ¡k',
        options: ['GyÃ¶kÃ©r csakra', 'SzakrÃ¡lis csakra', 'Napfonat csakra', 'SzÃ­v csakra', 'Torok csakra', '3. szem', 'Korona csakra'],
        colors: ['#fecaca','#fed7aa','#fde68a','#bbf7d0','#bfdbfe','#ddd6fe','#e9d5ff']
    },
    blokkJelleg: {
        title: 'Blokk Jellege',
        options: ['Ã‰rzelmi blokk', 'MentÃ¡lis blokk', 'Fizikai blokk', 'Energetikai blokk', 'SpirituÃ¡lis blokk', 'Karmikus blokk', 'Lelki blokk', 'CsalÃ¡di blokk', 'Åsi/AncestrÃ¡lis blokk', 'TÃ¡rsadalmi/KollektÃ­v blokk', 'Kapcsolati blokk'],
        colors: ['#fecaca','#fed7aa','#fde68a','#fef3c7','#d9f99d','#bbf7d0','#a7f3d0','#99f6e4','#a5f3fc','#bfdbfe','#c7d2fe']
    },
    vedekezes: {
        title: 'VÃ©dekezÃ©si Mechanizmus',
        options: ['TagadÃ¡s', 'ElfojtÃ¡s', 'KivetÃ­tÃ©s', 'Ã‰sszerÅ±sÃ­tÃ©s', 'KompenzÃ¡ciÃ³', 'ElkerÃ¼lÃ©s', 'AgressziÃ³', 'TÃ¶kÃ©letessÃ©gre tÃ¶rekvÃ©s', 'Kontroll', 'FÃ¼ggÅ‘sÃ©g', 'DisszociÃ¡ciÃ³/LevÃ¡lÃ¡s', 'Humor', 'TÃºlgondolÃ¡s', 'ÃbrÃ¡ndozÃ¡s/MenekÃ¼lÃ©s', 'Burkolt agressziÃ³', 'Ã‰rzelmi tÃ¡volsÃ¡gtartÃ¡s'],
        colors: ['#fca5a5','#fcd5d5','#fecaca','#fecdd3','#fca5a5','#fed7aa','#fde68a','#fef3c7','#fef9d5','#d9f99d','#bbf7d0','#d9f99d','#a7f3d0','#99f6e4','#fcd5d5','#e5e7eb']
    },
    szerepek: {
        title: 'Ã‰letszerepek',
        options: ['SzÃ¼lÅ‘ szerepben', 'Partner szerepben', 'MunkavÃ¡llalÃ³', 'VezetÅ‘ szerepben', 'Gyerek szerepben', 'BarÃ¡t szerepben', 'KollÃ©ga szerepben', 'EgyedÃ¼l/MagÃ¡nÃ©let', 'KÃ¶zÃ¶ssÃ©gben', 'AlkotÃ³/KreatÃ­v', 'GyermekkÃ©nt a szÃ¼leim elÅ‘tt', 'SpirituÃ¡lis/TanÃ­tÃ³ szerepben', 'SegÃ­tÅ‘/GyÃ³gyÃ­tÃ³ szerepben'],
        colors: ['#fbcfe8','#fecaca','#fde68a','#fef3c7','#d9f99d','#bbf7d0','#99f6e4','#bfdbfe','#c7d2fe','#e9d5ff','#f5d0fe','#ddd6fe','#a7f3d0']
    },
    szabotazs: {
        title: 'SzabotÃ¡zs MintÃ¡k',
        options: ['HalogatÃ¡s', 'TÃ¶kÃ©letesÃ­tÃ©s', 'FÃ©lbehagyÃ¡s', 'Ã–nkritika', 'TÃºlvÃ¡llalÃ¡s', 'Kontroll igÃ©nye', 'Ã–sszehasonlÃ­tÃ¡s', 'KÃ¼zdelem', 'Gyors feladÃ¡s', 'MenekÃ¼lÃ©s', 'Nincs szabotÃ¡zs'],
        colors: ['#fca5a5','#fcd5d5','#fecaca','#fecdd3','#fca5a5','#fed7aa','#fde68a','#fef3c7','#fef9d5','#d9f99d','#bbf7d0']
    },
    haszon: {
        title: 'MÃ¡sodlagos Haszon',
        options: ['BiztonsÃ¡got ad', 'IdentitÃ¡st ad', 'Figyelmet kapok', 'Szeretetet kapok', 'Nem kell vÃ¡ltoznom', 'Nem kell felelÅ‘ssÃ©g', 'ElkerÃ¼lÃ¶m a kudarcot', 'VÃ©delmez mÃ¡sok elÅ‘l', 'Igazol engem', 'Nem kell teljesÃ­tenem', 'SajnÃ¡lnak/EgyÃ¼ttÃ©rzÃ©st kapok'],
        colors: ['#fde68a','#fed7aa','#fecaca','#fbcfe8','#f5d0fe','#e9d5ff','#ddd6fe','#d8b4fe','#c7d2fe','#bfdbfe','#fef3c7']
    },
    fogadalom: {
        title: 'Fogadalmak',
        options: ['Soha nem leszek mint Å‘', 'Mindig vÃ©deni fogom magam', 'Soha nem engedem meg', 'Mindig erÅ‘s leszek', 'Soha nem bÃ­zom', 'Mindig egyedÃ¼l csinÃ¡lom', 'Soha nem fogok sÃ­rni', 'Mindig kontroll alatt', 'Ã–rÃ¶k hÅ±sÃ©g', 'CsalÃ¡di fogadalom', 'VallÃ¡si fogadalom', 'LÃ©lek szerzÅ‘dÃ©s', 'Soha nem leszek boldog', 'Mindig Ã¡ldozat leszek', 'Nem Ã©rdemlem meg a jÃ³t', 'Nincs fogadalom'],
        colors: ['#fca5a5','#fcd5d5','#fecaca','#fecdd3','#fca5a5','#fed7aa','#fde68a','#fef3c7','#fbcfe8','#ddd6fe','#d8b4fe','#a5f3fc','#fcd5d5','#fca5a5','#fed7aa','#bbf7d0']
    },
    mikroszkop: {
        title: 'MikroszkÃ³p - TovÃ¡bbi rÃ©szletek',
        options: ['CsalÃ¡di minta', 'TÃ¡rsadalmi kondicionÃ¡lÃ¡s', 'KulturÃ¡lis elvÃ¡rÃ¡s', 'Nemi szerep', 'VallÃ¡si tanÃ­tÃ¡s', 'Iskolai tapasztalat', 'MÃ©dia hatÃ¡s', 'KortÃ¡rs nyomÃ¡s', 'TÃ¶rtÃ©nelmi trauma', 'KollektÃ­v tudattalan', 'AncestrÃ¡lis Ã¡tÃ¶rÃ¶kÃ­tÃ©s', 'Lelki szerzÅ‘dÃ©s', 'Energetikai kapcsolat', 'Karmikus lenyomat', 'TÃ¡rslÃ©lek befolyÃ¡s', 'EntitÃ¡s attachment', 'Ãtkok/ÃtkozÃ¡sok', 'Nincs tÃ¶bb rÃ©szlet'],
        colors: ['#fecaca','#fed7aa','#fde68a','#fef3c7','#d9f99d','#bbf7d0','#99f6e4','#a5f3fc','#bfdbfe','#c7d2fe','#ddd6fe','#e9d5ff','#f5d0fe','#fecdd3','#fbcfe8','#fca5a5','#fed7aa','#bbf7d0']
    },
    pozitivErzelem: {
        title: 'PozitÃ­v Ã‰rzelmek',
        options: ['Ã–rÃ¶m', 'BÃ©ke', 'Szeretet', 'HÃ¡la', 'SzabadsÃ¡g', 'Bizalom', 'BÃ¡torsÃ¡g', 'RemÃ©ny', 'LelkesedÃ©s', 'MegelÃ©gedettsÃ©g', 'BiztonsÃ¡g', 'KÃ¶nnyedsÃ©g'],
        colors: ['#fef3c7','#fef9d5','#fef3c7','#fde68a','#fed7aa','#fcd34d','#fef3c7','#fef9d5','#fef9c3','#d9f99d','#bbf7d0','#d9f99d']
    },
    ujHit: {
        title: 'Ãšj Hiedelmek',
        options: ['ElÃ©g jÃ³ vagyok', 'MegÃ©rdemlem a jÃ³t', 'SzerethetÅ‘ vagyok', 'ErÅ‘s vagyok', 'Sikereket Ã©rek el', 'BiztonsÃ¡gos a siker', 'Boldog lehetek', 'TehetsÃ©ges vagyok', 'VÃ¡ltozhatok Ã©s fejlÅ‘dhetek', 'BÃ­zom magamban', 'Elfogadom magam', 'MegbocsÃ¡tok magamnak'],
        colors: ['#bbf7d0','#a7f3d0','#99f6e4','#99f6e4','#a5f3fc','#bfdbfe','#a5f3fc','#bfdbfe','#c7d2fe','#bfdbfe','#c7d2fe','#ddd6fe']
    },
    szinek: {
        title: 'GyÃ³gyÃ­tÃ³ SzÃ­nek',
        options: ['FehÃ©r (tisztasÃ¡g)', 'Arany (bÃ¶lcsessÃ©g)', 'EzÃ¼st (intuÃ­ciÃ³)', 'Lila (spiritualitÃ¡s)', 'KÃ©k (kommunikÃ¡ciÃ³)', 'ZÃ¶ld (gyÃ³gyulÃ¡s)', 'RÃ³zsaszÃ­n (szeretet)', 'NarancssÃ¡rga (kreativitÃ¡s)', 'SÃ¡rga (Ã¶rÃ¶m)', 'TÃ¼rkiz (vÃ©delem)', 'Fekete (vÃ©delem/fÃ¶ldelÃ©s)'],
        colors: ['#fafafa','#fef3c7','#e5e7eb','#e9d5ff','#bfdbfe','#bbf7d0','#fbcfe8','#fed7aa','#fef3c7','#99f6e4','#374151']
    },
    kristaly: {
        title: 'GyÃ³gyÃ­tÃ³ KristÃ¡lyok',
        options: ['HegyikristÃ¡ly', 'Ã“nix', 'Szodalit', 'Tigrisszem', 'RÃ³zsakvarc', 'Hematit', 'Ametiszt', 'Aventurin', 'AchÃ¡t', 'Citrin', 'Karneol', 'HoldkÅ‘', 'JÃ¡spis', 'Howlit', 'Cseresznyekvarc', 'ObszidiÃ¡n'],
        colors: ['#e5e7eb','#2d3748','#93c5fd','#fcd34d','#fbcfe8','#6b7280','#ddd6fe','#86efac','#d1d5db','#fef3c7','#fed7aa','#f3f4f6','#fca5a5','#fecdd3','#fbb6ce','#4a5568']
    }
};

function init() {
    renderStepsGrid();
    loadStep(0);
}

function renderStepsGrid() {
    const grid = document.getElementById('stepsGrid');
    grid.innerHTML = steps.map((step, i) => {
        let className = 'step-icon pending';
        if (i === currentStep) className = 'step-icon active';
        else if (completedSteps.includes(i)) className = 'step-icon completed';
        return '<div class="' + className + '" onclick="jumpToStep(' + i + ')" title="' + step.name + '">' + step.icon + '</div>';
    }).join('');
    
    const percent = Math.round((currentStep / steps.length) * 100);
    document.getElementById('stepInfo').textContent = currentStep + '/' + steps.length + ' lÃ©pÃ©s';
    document.getElementById('percentInfo').textContent = percent + '%';
    document.getElementById('progressBar').style.width = percent + '%';
}

function loadStep(stepIndex) {
    currentStep = stepIndex;
    selectedOptions = [];
    renderStepsGrid();
    
    const step = steps[stepIndex];
    const card = document.getElementById('contentCard');
    
    let html = '<h2>' + step.icon + ' ' + step.name + '</h2>';
    
    switch(stepIndex) {
        case 0:
            html += '<div class="info-box purple"><p><strong>ÃœdvÃ¶zÃ¶llek a blokkoldÃ³ folyamatban!</strong></p><p style="margin-top: 12px;">KÃ©szÃ¼ljetek fel a munkÃ¡ra: keressetek egy csendes helyet, vegyetek mÃ©ly lÃ©legzeteket, Ã©s nyissÃ¡tok meg magatokat a vÃ¡ltozÃ¡sra.</p><p style="margin-top: 12px;">A kezelÅ‘ vÃ©gigkÃ­sÃ©ri a klienst minden lÃ©pÃ©sen, megbeszÃ©lik a kapott Ã©rtÃ©keket Ã©s kÃ¶zÃ¶sen dolgoznak a blokk feloldÃ¡sÃ¡n.</p></div><div class="info-box blue" style="margin-top: 16px;"><label style="display: block; margin-bottom: 8px; font-weight: 600;">Kliens neve (opcionÃ¡lis):</label><input type="text" id="clientName" placeholder="NÃ©v megadÃ¡sa..." value="' + sessionData.clientName + '"></div><button class="btn btn-purple" onclick="saveClientName(); nextStep();">KezdjÃ¼k! â†’</button>';
            break;
            
        case 17:
            html += '<div class="info-box purple"><p><strong>TEM MÃ©rÃ©s - HÃ¡rom dimenziÃ³ vizsgÃ¡lata</strong></p><p style="margin-top: 12px;">MÃ©rd meg az ingÃ¡val, hogy melyik szinten milyen erÅ‘s a blokk:</p></div><div class="slider-container"><div class="slider-group"><label>ğŸ«€ Testi szint (0-100%)</label><div class="slider-wrapper"><input type="range" min="0" max="100" value="' + sessionData.temValues.Testi + '" class="slider" id="testiSlider" oninput="updateSliderValue(\'Testi\')"><span class="slider-value" id="testiValue">' + sessionData.temValues.Testi + '%</span></div></div><div class="slider-group"><label>ğŸ’­ Ã‰rzelmi szint (0-100%)</label><div class="slider-wrapper"><input type="range" min="0" max="100" value="' + sessionData.temValues.Erzelmi + '" class="slider" id="erzelmiSlider" oninput="updateSliderValue(\'Erzelmi\')"><span class="slider-value" id="erzelmiValue">' + sessionData.temValues.Erzelmi + '%</span></div></div><div class="slider-group"><label>ğŸ§  MentÃ¡lis szint (0-100%)</label><div class="slider-wrapper"><input type="range" min="0" max="100" value="' + sessionData.temValues.Mentalis + '" class="slider" id="mentalisSlider" oninput="updateSliderValue(\'Mentalis\')"><span class="slider-value" id="mentalisValue">' + sessionData.temValues.Mentalis + '%</span></div></div></div><div class="btn-grid"><button class="btn btn-secondary" onclick="prevStep()">â† Vissza</button><button class="btn btn-purple" onclick="saveTEM()">MentÃ©s Ã©s tovÃ¡bb â†’</button></div>';
            break;
            
        case 25:
            html += '<div class="info-box yellow"><p><strong>Most kÃ¶vetkezik az oldÃ¡s pillanata!</strong></p><p style="margin-top: 12px;">A kezelÅ‘ kÃ©ri az ingÃ¡t, hogy oldja fel a blokkot. FigyeljÃ©tek meg egyÃ¼tt a mozgÃ¡st, Ã©s vÃ¡rjÃ¡tok meg, amÃ­g megÃ¡ll.</p></div><div class="info-box green" style="margin-top: 16px;"><p style="text-align: center; font-size: 1.1rem;">âœ¨ <em>"Elengedem ezt a blokkot. SzabaddÃ¡ vÃ¡lok. KÃ¶szÃ¶nÃ¶m a tanulsÃ¡got, ami mÃ¶gÃ¶tte rejlett."</em></p></div><button class="btn btn-purple" onclick="nextStep()">OldÃ¡s megtÃ¶rtÃ©nt â†’</button>';
            break;
            
        case 31:
            generateReleasingText();
            generateIntegratingText();
            html += '<div class="info-box purple"><p><strong>OldÃ³ Ã©s integrÃ¡lÃ³ affirmÃ¡ciÃ³k</strong></p><p style="margin-top: 8px;">A kezelÅ‘ felolvassa az alÃ¡bbi szÃ¶vegeket a kliensnek, majd kÃ¶zÃ¶sen Ã¡tbeszÃ©lik Å‘ket. A szÃ¶vegek szerkeszthetÅ‘k.</p></div>';
            html += '<h3 style="margin-top: 24px; color: #7e22ce;">ğŸ“– OldÃ³ szÃ¶veg:</h3>';
            html += '<textarea id="releasingTextArea" style="min-height: 200px;">' + sessionData.releasingTexts + '</textarea>';
            html += '<h3 style="margin-top: 24px; color: #7e22ce;">ğŸ’« IntegrÃ¡lÃ³ szÃ¶veg:</h3>';
            html += '<textarea id="integratingTextArea" style="min-height: 200px;">' + sessionData.integratingTexts + '</textarea>';
            html += '<button class="btn btn-purple" onclick="saveTexts(); nextStep()">MentÃ©s Ã©s folytatÃ¡s â†’</button>';
            break;
            
        case 32:
            html += '<div class="info-box green"><p><strong>ğŸ‰ A blokkoldÃ³ kezelÃ©s befejezÅ‘dÃ¶tt!</strong></p><p style="margin-top: 8px;">A kezelÅ‘ most elkÃ©szÃ­ti a kezelÅ‘lapot, amit Ã¡tad a kliensnek Ã©s megtart magÃ¡nak dokumentÃ¡ciÃ³kÃ©nt.</p></div>';
            html += '<div class="summary-section"><h3>ğŸ“Š Munkamenet Ã¶sszefoglalÃ³</h3>';
            html += '<p><strong>Kliens:</strong> ' + (sessionData.clientName || 'N/A') + '</p>';
            html += '<p><strong>Kezdeti mÃ©rÃ©s:</strong> ' + (sessionData.measurements.initial || 'N/A') + '</p>';
            html += '<p><strong>ZÃ¡rÃ³ mÃ©rÃ©s:</strong> ' + (sessionData.measurements.final || 'N/A') + '</p>';
            if (sessionData.measurements.initial && sessionData.measurements.final) {
                const improvement = parseInt(sessionData.measurements.initial.replace('%','')) - parseInt(sessionData.measurements.final.replace('%',''));
                html += '<p><strong>VÃ¡ltozÃ¡s:</strong> ' + (improvement > 0 ? '-' : '+') + Math.abs(improvement) + '% ' + (improvement > 0 ? 'âœ…' : 'âš ï¸') + '</p>';
            }
            html += '<p style="margin-top: 16px;"><strong>TEM Ã©rtÃ©kek:</strong></p>';
            html += '<p>â€¢ Testi: ' + sessionData.temValues.Testi + '%</p>';
            html += '<p>â€¢ Ã‰rzelmi: ' + sessionData.temValues.Erzelmi + '%</p>';
            html += '<p>â€¢ MentÃ¡lis: ' + sessionData.temValues.Mentalis + '%</p>';
            
            if (Object.keys(sessionData.answers).length > 0) {
                html += '<p style="margin-top: 16px;"><strong>Kiemelt vÃ¡laszok:</strong></p>';
                for (let stepId in sessionData.answers) {
                    const step = steps[stepId];
                    if (step && sessionData.answers[stepId]) {
                        html += '<p>â€¢ <em>' + step.name + ':</em> ' + sessionData.answers[stepId] + '</p>';
                    }
                }
            }
            html += '</div>';
            html += '<button class="btn btn-download" onclick="saveSessionDOCX()">ğŸ’¾ KezelÅ‘lap mentÃ©se (.doc)</button>';
            html += '<button class="btn btn-purple" style="margin-top: 16px;" onclick="confirmFinish()">âœ¨ Ãšj kezelÃ©s indÃ­tÃ¡sa</button>';
            break;
            
        default:
            if (step.diagram) {
                html += '<div class="question-box">â“ ' + step.question + '</div>';
                html += '<div class="info-box blue"><p>HasznÃ¡ld az ingÃ¡t a vÃ¡lasz megtalÃ¡lÃ¡sÃ¡hoz. ' + (step.multiple ? 'TÃ¶bb opciÃ³ is kivÃ¡laszthatÃ³.' : '') + '</p></div>';
                html += '<button class="btn btn-primary" onclick="openDiagram(\'' + step.diagram + '\', ' + step.multiple + ')">IngÃ¡s mÃ©rÃ©s â†’</button>';
                if (sessionData.answers[stepIndex]) {
                    html += '<div class="answer-display"><div class="answer-label">VÃ¡lasz:</div><div class="answer-value">' + sessionData.answers[stepIndex] + '</div></div>';
                }
            } else {
                html += '<div class="info-box purple"><p>FolytassÃ¡tok a kÃ¶vetkezÅ‘ lÃ©pÃ©ssel.</p></div><button class="btn btn-purple" onclick="nextStep()">TovÃ¡bb â†’</button>';
            }
    }
    
    card.innerHTML = html;
    
    const navCard = document.getElementById('navigationCard');
    if (stepIndex > 0 && stepIndex < steps.length - 1 && stepIndex !== 17 && stepIndex !== 31) {
        navCard.style.display = 'block';
    } else {
        navCard.style.display = 'none';
    }
}

function saveClientName() {
    const nameInput = document.getElementById('clientName');
    if (nameInput) {
        sessionData.clientName = nameInput.value.trim();
    }
}

function updateSliderValue(type) {
    const slider = document.getElementById(type.toLowerCase() + 'Slider');
    const valueDisplay = document.getElementById(type.toLowerCase() + 'Value');
    valueDisplay.textContent = slider.value + '%';
}

function saveTEM() {
    sessionData.temValues.Testi = parseInt(document.getElementById('testiSlider').value);
    sessionData.temValues.Erzelmi = parseInt(document.getElementById('erzelmiSlider').value);
    sessionData.temValues.Mentalis = parseInt(document.getElementById('mentalisSlider').value);
    
    if (!completedSteps.includes(currentStep)) {
        completedSteps.push(currentStep);
    }
    nextStep();
}

function saveTexts() {
    sessionData.releasingTexts = document.getElementById('releasingTextArea').value;
    sessionData.integratingTexts = document.getElementById('integratingTextArea').value;
}

function createCircleDiagram(diag, type) {
    const opts = diag.options;
    const colors = diag.colors;
    const angleStep = 360 / opts.length;
    const centerX = 300, centerY = 300, radius = 250;
    
    let paths = '';
    
    opts.forEach(function(opt, i) {
        const angle1 = (i * angleStep - 90) * Math.PI / 180;
        const angle2 = ((i + 1) * angleStep - 90) * Math.PI / 180;
        const x1 = centerX + radius * Math.cos(angle1);
        const y1 = centerY + radius * Math.sin(angle1);
        const x2 = centerX + radius * Math.cos(angle2);
        const y2 = centerY + radius * Math.sin(angle2);
        
        const midAngle = (angle1 + angle2) / 2;
        const textRadius = radius * 0.65;
        const textX = centerX + textRadius * Math.cos(midAngle);
        const textY = centerY + textRadius * Math.sin(midAngle);
        
        let rotationAngle = (midAngle * 180 / Math.PI);
        
        const escaped = opt.replace(/'/g, '&#39;');
        const textLen = opt.length;
        const fontSize = textLen > 25 ? 10 : (textLen > 20 ? 11 : (textLen > 15 ? 12 : (textLen > 10 ? 13 : 14)));
        
        paths += '<path class="diagram-sector" d="M' + centerX + ',' + centerY + ' L' + x1 + ',' + y1 + ' A' + radius + ',' + radius + ' 0 0,1 ' + x2 + ',' + y2 + ' Z" fill="' + colors[i] + '" onclick="toggleOption(\'' + escaped + '\', ' + steps[currentStep].multiple + ')" style="cursor: pointer; transition: all 0.2s; stroke: #fff; stroke-width: 2;" onmouseover="this.style.opacity=0.8; this.style.strokeWidth=3;" onmouseout="this.style.opacity=1; this.style.strokeWidth=2;" />';
        paths += '<text x="' + textX + '" y="' + textY + '" font-size="' + fontSize + '" text-anchor="middle" dominant-baseline="middle" transform="rotate(' + rotationAngle + ' ' + textX + ' ' + textY + ')" style="pointer-events: none; font-weight: bold; fill: #1f2937; text-shadow: 0px 0px 4px rgba(255,255,255,0.9);">' + opt + '</text>';
    });
    
    return '<svg viewBox="0 0 600 600" style="width: 100%; max-width: 600px; height: auto; margin: 20px auto; display: block;">' + paths + '</svg>';
}

function openDiagram(type, isMultiple) {
    const diag = diagrams[type];
    if (!diag) return;
    
    const step = steps[currentStep];
    document.getElementById('diagramTitle').textContent = diag.title;
    document.getElementById('diagramQuestion').textContent = step.question || '';
    
    // Restore previously selected options
    if (sessionData.answers[currentStep]) {
        selectedOptions = sessionData.answers[currentStep].split(', ');
    } else {
        selectedOptions = [];
    }
    
    let html = createCircleDiagram(diag, type);
    html += '<div class="diagram-grid" style="margin-top: 24px;">';
    diag.options.forEach(function(opt) {
        const isSelected = selectedOptions.includes(opt);
        const selectedClass = isSelected ? ' selected' : '';
        html += '<button class="diagram-button' + selectedClass + '" onclick="toggleOption(\'' + opt.replace(/'/g, "&#39;") + '\', ' + isMultiple + ')">' + opt + '</button>';
    });
    html += '</div>';
    
    if (isMultiple) {
        html += '<button class="btn btn-purple" style="margin-top: 16px;" onclick="saveMultipleOptions()">KivÃ¡lasztÃ¡s mentÃ©se</button>';
        html += '<button class="btn btn-skip" style="margin-top: 8px;" onclick="skipDiagram()">KihagyÃ¡s</button>';
    } else {
        html += '<button class="btn btn-skip" style="margin-top: 16px;" onclick="skipDiagram()">KihagyÃ¡s</button>';
    }
    html += '<button class="btn btn-secondary" style="margin-top: 8px;" onclick="closeDiagram()">BezÃ¡rÃ¡s</button>';
    
    document.getElementById('diagramContent').innerHTML = html;
    document.getElementById('diagramModal').classList.add('active');
}

function toggleOption(option, isMultiple) {
    const index = selectedOptions.indexOf(option);
    
    if (isMultiple) {
        // Multiple selection mode
        if (index > -1) {
            selectedOptions.splice(index, 1);
        } else {
            selectedOptions.push(option);
        }
        // Update button states
        const buttons = document.querySelectorAll('.diagram-button');
        buttons.forEach(btn => {
            if (btn.textContent === option) {
                btn.classList.toggle('selected');
            }
        });
    } else {
        // Single selection mode - save immediately
        if (currentStep === 2) {
            sessionData.measurements.initial = option;
        } else if (currentStep === 14) {
            // TEM - Testi
            sessionData.temValues.Testi = parseInt(option);
        } else if (currentStep === 15) {
            // TEM - Ã‰rzelmi
            sessionData.temValues.Erzelmi = parseInt(option);
        } else if (currentStep === 16) {
            // TEM - MentÃ¡lis
            sessionData.temValues.Mentalis = parseInt(option);
        } else if (currentStep === 30) {
            sessionData.measurements.final = option;
        } else {
            sessionData.answers[currentStep] = option;
        }
        
        closeDiagram();
        
        if (!completedSteps.includes(currentStep)) {
            completedSteps.push(currentStep);
        }
        
        loadStep(currentStep);
    }
}

function saveMultipleOptions() {
    if (selectedOptions.length > 0) {
        sessionData.answers[currentStep] = selectedOptions.join(', ');
    }
    
    closeDiagram();
    
    if (!completedSteps.includes(currentStep)) {
        completedSteps.push(currentStep);
    }
    
    loadStep(currentStep);
}

function skipDiagram() {
    sessionData.answers[currentStep] = 'Kihagyva';
    
    closeDiagram();
    
    if (!completedSteps.includes(currentStep)) {
        completedSteps.push(currentStep);
    }
    
    loadStep(currentStep);
}

function closeDiagram() {
    document.getElementById('diagramModal').classList.remove('active');
}

function generateReleasingText() {
    let parts = [];
    
    parts.push("Elengedem ezt a blokkot, amely eddig visszatartott az Ã©letemben.");
    
    if (sessionData.answers[3]) {
        parts.push("Felszabadulok a(z) " + sessionData.answers[3].toLowerCase() + " terÃ¼letÃ©n mÅ±kÃ¶dÅ‘ korlÃ¡taimtÃ³l.");
    }
    
    if (sessionData.answers[4] || sessionData.answers[5]) {
        const emotion = sessionData.answers[5] || sessionData.answers[4];
        parts.push("Elengedem a " + emotion.toLowerCase() + " Ã©rzÃ©sÃ©t, amely Ã¡thatotta a lÃ©temet.");
    }
    
    if (sessionData.answers[6]) {
        parts.push("GyÃ³gyÃ­tom a " + sessionData.answers[6].toLowerCase() + " nyomait.");
    }
    
    if (sessionData.answers[7]) {
        parts.push("GyÃ³gyÃ­tom a " + sessionData.answers[7].toLowerCase() + " okozta sebeket.");
    }
    
    if (sessionData.answers[8]) {
        parts.push("BÃ©kÃ©ben elengedem azt, ami a " + sessionData.answers[8].toLowerCase() + " kapcsolatÃ¡bÃ³l eredt.");
    }
    
    if (sessionData.answers[10]) {
        parts.push("Nem hiszek tovÃ¡bb abban, hogy \"" + sessionData.answers[10].toLowerCase() + "\".");
    }
    
    if (sessionData.answers[18]) {
        parts.push("Nem szÃ¼ksÃ©ges tÃ¶bbÃ© a " + sessionData.answers[18].toLowerCase() + ", vÃ©dtelen vagyok Ã©s ez rendben van.");
    }
    
    if (sessionData.answers[20] && sessionData.answers[20] !== 'Nincs szabotÃ¡zs') {
        parts.push("Elengedem az Ã¶nszabotÃ¡zs mintÃ¡t: " + sessionData.answers[20].toLowerCase() + ".");
    }
    
    if (sessionData.answers[21]) {
        parts.push("Felismerem Ã©s elengedem a mÃ¡sodlagos hasznot: " + sessionData.answers[21].toLowerCase() + ".");
    }
    
    if (sessionData.answers[22] && sessionData.answers[22] !== 'Nincs fogadalom') {
        parts.push("Feloldom a fogadalmat: \"" + sessionData.answers[22].toLowerCase() + "\".");
    }
    
    parts.push("KÃ¶szÃ¶nÃ¶m a tanulsÃ¡got, amit ez a blokk hozott szÃ¡momra.");
    parts.push("Most szabadon engedem, Ã©s nyitott vagyok az Ãºj lehetÅ‘sÃ©gekre.");
    
    sessionData.releasingTexts = parts.join('\n\n');
}

function generateIntegratingText() {
    let parts = [];
    
    parts.push("Elfogadom az Ãºj valÃ³sÃ¡gomat, amelyben szabad Ã©s egÃ©sz vagyok.");
    
    if (sessionData.answers[26]) {
        parts.push(sessionData.answers[26] + " tÃ¶lti el a szÃ­vemet Ã©s a testemet.");
    }
    
    if (sessionData.answers[27]) {
        parts.push("Ãšj hitem: " + sessionData.answers[27] + ".");
    }
    
    if (sessionData.answers[3]) {
        parts.push("A(z) " + sessionData.answers[3].toLowerCase() + " terÃ¼letÃ©n szabadon kibontakozom.");
    }
    
    if (sessionData.answers[8]) {
        parts.push("EgÃ©szsÃ©ges Ã©s tÃ¡plÃ¡lÃ³ kapcsolatokat Ã©pÃ­tek, szabadon Ã©s szeretettel.");
    }
    
    if (sessionData.answers[11]) {
        parts.push("A testem " + sessionData.answers[11].toLowerCase() + " terÃ¼lete gyÃ³gyul Ã©s erÅ‘sÃ¶dik.");
    }
    
    if (sessionData.answers[12]) {
        parts.push("A " + sessionData.answers[12].toLowerCase() + " harmonizÃ¡lÃ³dik Ã©s Ã¡ramlik bennem az energia.");
    }
    
    if (sessionData.answers[28]) {
        const szin = sessionData.answers[28].split('(')[0].trim();
        parts.push(szin + " fÃ©ny vesz kÃ¶rÃ¼l Ã©s gyÃ³gyÃ­t.");
    }
    
    if (sessionData.answers[29]) {
        parts.push(sessionData.answers[29] + " energiÃ¡ja tÃ¡mogat Ã©s erÅ‘sÃ­t.");
    }
    
    parts.push("HÃ¡lÃ¡s vagyok a vÃ¡ltozÃ¡sÃ©rt Ã©s az Ãºj lehetÅ‘sÃ©gekÃ©rt.");
    parts.push("Bizalommal lÃ©pek elÅ‘re az Ã©letemben, tudva, hogy megÃ©rdemlem a jÃ³t.");
    
    sessionData.integratingTexts = parts.join('\n\n');
}

function saveSessionDOCX() {
    // Make sure texts are generated
    if (!sessionData.releasingTexts) {
        generateReleasingText();
    }
    if (!sessionData.integratingTexts) {
        generateIntegratingText();
    }
    
    sessionData.timestamp = new Date().toISOString();
    const datum = new Date(sessionData.timestamp).toLocaleString('hu-HU');
    const clientInfo = sessionData.clientName || 'N/A';
    
    // Generate text report
    let report = 'â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n';
    report += '                    INGÃS BLOKKOLDÃ“ KEZELÅLAP\n';
    report += 'â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\n';
    report += 'Kliens: ' + clientInfo + '\n';
    report += 'DÃ¡tum: ' + datum + '\n\n';
    report += 'â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n';
    report += 'MÃ‰RÃ‰SEK\n';
    report += 'â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n';
    report += 'Kezdeti mÃ©rÃ©s: ' + (sessionData.measurements.initial || 'N/A') + '\n';
    report += 'ZÃ¡rÃ³ mÃ©rÃ©s: ' + (sessionData.measurements.final || 'N/A') + '\n';
    
    if (sessionData.measurements.initial && sessionData.measurements.final) {
        const initial = parseInt(sessionData.measurements.initial.replace('%',''));
        const final = parseInt(sessionData.measurements.final.replace('%',''));
        const change = initial - final;
        report += 'VÃ¡ltozÃ¡s: ' + change + '%\n';
    }
    
    report += '\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n';
    report += 'TEM MÃ‰RÃ‰S (Testi-Ã‰rzelmi-MentÃ¡lis)\n';
    report += 'â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n';
    report += 'Testi szint: ' + sessionData.temValues.Testi + '%\n';
    report += 'Ã‰rzelmi szint: ' + sessionData.temValues.Erzelmi + '%\n';
    report += 'MentÃ¡lis szint: ' + sessionData.temValues.Mentalis + '%\n';
    
    report += '\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n';
    report += 'FELTÃRT TERÃœLETEK\n';
    report += 'â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n';
    for (let stepId in sessionData.answers) {
        const step = steps[stepId];
        if (step && sessionData.answers[stepId] && sessionData.answers[stepId] !== 'Kihagyva') {
            report += step.name + ': ' + sessionData.answers[stepId] + '\n';
        }
    }
    
    report += '\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n';
    report += 'OLDÃ“ SZÃ–VEG\n';
    report += 'â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n';
    report += sessionData.releasingTexts + '\n';
    
    report += '\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n';
    report += 'INTEGRÃLÃ“ SZÃ–VEG\n';
    report += 'â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n';
    report += sessionData.integratingTexts + '\n';
    
    report += '\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n';
    report += '                        KEZELÃ‰S VÃ‰GE\n';
    report += 'â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\n';
    report += 'KezelÅ‘ alÃ¡Ã­rÃ¡sa: _______________________\n\n';
    report += 'MegjegyzÃ©sek:\n';
    report += '_______________________________________________________________\n';
    report += '_______________________________________________________________\n';
    
    // Create and download file
    try {
        const fileName = sessionData.clientName ? 
            'Kezelolap_' + sessionData.clientName.replace(/\s+/g, '_') + '_' + new Date().toISOString().slice(0,10) + '.doc' : 
            'Kezelolap_' + new Date().toISOString().slice(0,10) + '.doc';
        
        const blob = new Blob(['\uFEFF' + report], { type: 'application/msword;charset=utf-8' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.style.display = 'none';
        a.href = url;
        a.download = fileName;
        
        document.body.appendChild(a);
        a.click();
        
        setTimeout(function() {
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            alert('âœ… KezelÅ‘lap sikeresen mentve!\n\n' + fileName);
        }, 100);
    } catch (error) {
        console.error('Save error:', error);
        alert('âŒ Hiba tÃ¶rtÃ©nt a mentÃ©s sorÃ¡n. PrÃ³bÃ¡ld Ãºjra!');
    }
}

function nextStep() {
    if (currentStep < steps.length - 1) {
        if (!completedSteps.includes(currentStep)) {
            completedSteps.push(currentStep);
        }
        loadStep(currentStep + 1);
    }
}

function prevStep() {
    if (currentStep > 0) {
        loadStep(currentStep - 1);
    }
}

function jumpToStep(index) {
    loadStep(index);
}

function confirmFinish() {
    if (confirm('ğŸ™ Ãšj kezelÃ©st indÃ­tasz? A jelenlegi adatok elvesznek, ha nem mentetted el!')) {
        resetSession();
    }
}

function resetSession() {
    currentStep = 0;
    completedSteps = [];
    selectedOptions = [];
    sessionData = {
        answers: {},
        measurements: { initial: null, final: null },
        temValues: { Testi: 0, Erzelmi: 0, Mentalis: 0 },
        releasingTexts: '',
        integratingTexts: '',
        timestamp: null,
        clientName: ''
    };
    init();
}

init();
    </script>

</div>

<script>
// Login codes
var validCodes=["IBAR-2025-001","IBAR-2025-002","IBAR-2025-003","IBAR-2025-004","IBAR-2025-005","IBAR-2025-006","IBAR-2025-007","IBAR-2025-008","IBAR-2025-009","IBAR-2025-010","IBAR-2025-011","IBAR-2025-012","IBAR-2025-013","IBAR-2025-014","IBAR-2025-015","IBAR-2025-016","IBAR-2025-017","IBAR-2025-018","IBAR-2025-019","IBAR-2025-020","IBAR-2025-021","IBAR-2025-022","IBAR-2025-023","IBAR-2025-024","IBAR-2025-025","IBAR-2025-026","IBAR-2025-027","IBAR-2025-028","IBAR-2025-029","IBAR-2025-030","IBAR-2025-031","IBAR-2025-032","IBAR-2025-033","IBAR-2025-034","IBAR-2025-035","IBAR-2025-036","IBAR-2025-037","IBAR-2025-038","IBAR-2025-039","IBAR-2025-040","IBAR-2025-041","IBAR-2025-042","IBAR-2025-043","IBAR-2025-044","IBAR-2025-045","IBAR-2025-046","IBAR-2025-047","IBAR-2025-048","IBAR-2025-049","IBAR-2025-050","IBAR-2025-051","IBAR-2025-052","IBAR-2025-053","IBAR-2025-054","IBAR-2025-055","IBAR-2025-056","IBAR-2025-057","IBAR-2025-058","IBAR-2025-059","IBAR-2025-060","IBAR-2025-061","IBAR-2025-062","IBAR-2025-063","IBAR-2025-064","IBAR-2025-065","IBAR-2025-066","IBAR-2025-067","IBAR-2025-068","IBAR-2025-069","IBAR-2025-070","IBAR-2025-071","IBAR-2025-072","IBAR-2025-073","IBAR-2025-074","IBAR-2025-075","IBAR-2025-076","IBAR-2025-077","IBAR-2025-078","IBAR-2025-079","IBAR-2025-080","IBAR-2025-081","IBAR-2025-082","IBAR-2025-083","IBAR-2025-084","IBAR-2025-085","IBAR-2025-086","IBAR-2025-087","IBAR-2025-088","IBAR-2025-089","IBAR-2025-090","IBAR-2025-091","IBAR-2025-092","IBAR-2025-093","IBAR-2025-094","IBAR-2025-095","IBAR-2025-096","IBAR-2025-097","IBAR-2025-098","IBAR-2025-099","IBAR-2025-100"];

function doLogin(){
  var inp=document.getElementById('codeInput');
  var err=document.getElementById('errMsg');
  var code=inp.value.trim().toUpperCase();
  err.classList.remove('show');
  if(validCodes.indexOf(code)!==-1){
    document.body.classList.add('logged-in');
    localStorage.setItem('ibar_logged','1');
  }else{
    err.classList.add('show');
    inp.value='';
  }
}

document.getElementById('codeInput').addEventListener('keypress',function(e){
  if(e.key==='Enter')doLogin();
});

// Check if already logged in
if(localStorage.getItem('ibar_logged')==='1'){
  document.body.classList.add('logged-in');
}

// IBAR App JavaScript

</script>
</body>
</html>
